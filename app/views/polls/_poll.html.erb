<div class="poll" id="poll-<%= poll.id %>">
  <%= cl_image_tag poll.photo.path, class: "poll-photo" %>
  <% unless poll.context.empty? %>
    <div class="poll-text" style= "top: <%= poll.context_y %>%">
        <%=poll.context%>
    </div>
  <% end %>
  <%= link_to (image_tag("smiley1.png")), poll_answers_path(poll, "answer" => {"value" => 1, "last" => local_assigns[:last] } ), class: "poll-button-yay", method: :post, remote: true %>
  <%= link_to (image_tag("pile-of-poo.png")), poll_answers_path(poll, "answer" => {"value" => 0, "last" => local_assigns[:last] } ), class: "poll-button-nay", method: :post, remote: true %>
  <%= render "polls/poll_info", poll: poll  %>
</div>

<% content_for(:after_js) do %>
<script>
$(function(){
 var $pollShow = false;
   $('#poll-<%= poll.id %> > img').on('touchstart', function(event){
     if ($pollShow == false) {
       $("#poll-info-<%= poll.id %>").removeClass('hide-info');
       $("#poll-info-<%= poll.id %>").addClass('show-info');
       $('#poll-<%= poll.id %> > div.poll-text').hide()
       $('#poll-<%= poll.id %> > a.poll-button-yay').hide()
       $('#poll-<%= poll.id %> > a.poll-button-nay').hide()
       $pollShow = true;
     } else {
       $("#poll-info-<%= poll.id %>").removeClass('show-info');
       $("#poll-info-<%= poll.id %>").addClass('hide-info');
       $('#poll-<%= poll.id %> > div.poll-text').show()
       $('#poll-<%= poll.id %> > a.poll-button-yay').show()
       $('#poll-<%= poll.id %> > a.poll-button-nay').show()
       $pollShow = false;
     }
   });
 });
</script>
<% end %>
